<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Five Sine Waves</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding: 16px; }
    .row { display: flex; align-items: center; gap: 12px; margin: 10px 0; }
    .row label { width: 70px; }
    .freq { width: 90px; font-variant-numeric: tabular-nums; }
    input[type="range"] { width: min(520px, 60vw); }
    button { padding: 6px 10px; }
    .hint { opacity: 0.8; margin-top: 8px; }
  </style>
</head>
<body>
  <h1>Five Sine Waves</h1>

  <button id="enableBtn">Enable Audio</button>
  <div class="hint">
    If you donâ€™t hear anything on iPhone/Safari, tap <b>Enable Audio</b> first (browser requirement).
  </div>

  <div id="controls"></div>

  <script>
    // ---- Audio setup (created lazily on first user gesture) ----
    let audioContext = null;
    let masterGain = null;

    // Safer levels: 5 sines summed can get loud. Master gain keeps headroom.
    const MASTER_GAIN_VALUE = 0.25;  // overall volume
    const WAVE_ON_GAIN_VALUE = 0.20; // per-wave volume when "on"

    const waves = []; // store { osc, gain, isPlaying, slider, freqSpan, button }

    function ensureAudio() {
      if (!audioContext) {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        masterGain = audioContext.createGain();
        masterGain.gain.value = MASTER_GAIN_VALUE;
        masterGain.connect(audioContext.destination);
      }
      return audioContext;
    }

    async function enableAudio() {
      ensureAudio();
      if (audioContext.state !== "running") {
        await audioContext.resume();
      }
    }

    document.getElementById("enableBtn").addEventListener("click", async () => {
      try {
        await enableAudio();
        document.getElementById("enableBtn").textContent =
          (audioContext.state === "running") ? "Audio Enabled" : "Enable Audio";
      } catch (e) {
        alert("Could not start audio. Try again, and make sure Silent Mode is off.");
        console.error(e);
      }
    });

    // ---- UI + waves ----
    function createWaveControl(index) {
      // Build UI first
      const container = document.createElement("div");
      container.className = "row";

      const label = document.createElement("label");
      label.textContent = `Wave ${index + 1}`;

      const slider = document.createElement("input");
      slider.type = "range";
      slider.min = "50";
      slider.max = "1000";
      slider.step = "1";
      slider.value = "440";

      cons
